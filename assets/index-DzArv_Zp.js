var Se=Object.defineProperty;var De=(t,e,n)=>e in t?Se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var W=(t,e,n)=>(De(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function h(){}function me(t){return t()}function oe(){return Object.create(null)}function k(t){t.forEach(me)}function pe(t){return typeof t=="function"}function D(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ee(t){return Object.keys(t).length===0}function _(t,e){t.appendChild(e)}function $(t,e,n){t.insertBefore(e,n||null)}function v(t){t.parentNode&&t.parentNode.removeChild(t)}function _e(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function x(t){return document.createTextNode(t)}function B(){return x(" ")}function Te(){return x("")}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ce(t){return Array.from(t.childNodes)}function V(t,e){e=""+e,t.data!==e&&(t.data=e)}function se(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}let J;function P(t){J=t}const N=[],ce=[];let H=[];const ae=[],Me=Promise.resolve();let Z=!1;function Oe(){Z||(Z=!0,Me.then(ye))}function G(t){H.push(t)}const q=new Set;let O=0;function ye(){if(O!==0)return;const t=J;do{try{for(;O<N.length;){const e=N[O];O++,P(e),Ne(e.$$)}}catch(e){throw N.length=0,O=0,e}for(P(null),N.length=0,O=0;ce.length;)ce.pop()();for(let e=0;e<H.length;e+=1){const n=H[e];q.has(n)||(q.add(n),n())}H.length=0}while(N.length);for(;ae.length;)ae.pop()();Z=!1,q.clear(),P(t)}function Ne(t){if(t.fragment!==null){t.update(),k(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}function He(t){const e=[],n=[];H.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),H=e}const A=new Set;let S;function ee(){S={r:0,c:[],p:S}}function te(){S.r||k(S.c),S=S.p}function g(t,e){t&&t.i&&(A.delete(t),t.i(e))}function y(t,e,n,r){if(t&&t.o){if(A.has(t))return;A.add(t),S.c.push(()=>{A.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function I(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function L(t){t&&t.c()}function E(t,e,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),G(()=>{const a=t.$$.on_mount.map(me).filter(pe);t.$$.on_destroy?t.$$.on_destroy.push(...a):k(a),t.$$.on_mount=[]}),o.forEach(G)}function T(t,e){const n=t.$$;n.fragment!==null&&(He(n.after_update),k(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function xe(t,e){t.$$.dirty[0]===-1&&(N.push(t),Oe(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function C(t,e,n,r,o,a,i=null,c=[-1]){const u=J;P(t);const s=t.$$={fragment:null,ctx:[],props:a,update:h,not_equal:o,bound:oe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:oe(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};i&&i(s.root);let l=!1;if(s.ctx=n?n(t,e.props||{},(f,d,...U)=>{const re=U.length?U[0]:d;return s.ctx&&o(s.ctx[f],s.ctx[f]=re)&&(!s.skip_bound&&s.bound[f]&&s.bound[f](re),l&&xe(t,f)),d}):[],s.update(),l=!0,k(s.before_update),s.fragment=r?r(s.ctx):!1,e.target){if(e.hydrate){const f=Ce(e.target);s.fragment&&s.fragment.l(f),f.forEach(v)}else s.fragment&&s.fragment.c();e.intro&&g(t.$$.fragment),E(t,e.target,e.anchor),ye()}P(u)}class M{constructor(){W(this,"$$");W(this,"$$set")}$destroy(){T(this,1),this.$destroy=h}$on(e,n){if(!pe(n))return h;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!Ee(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Le="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Le);function R(t){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(t)}function ne(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function b(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function j(t){b(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||R(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function ve(t,e){b(2,arguments);var n=j(t),r=ne(e);return isNaN(r)?new Date(NaN):(r&&n.setDate(n.getDate()+r),n)}function Ue(t,e){b(2,arguments);var n=j(t).getTime(),r=ne(e);return new Date(n+r)}function Pe(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function K(t){b(1,arguments);var e=j(t);return e.setHours(0,0,0,0),e}function be(t,e){b(2,arguments);var n=K(t),r=K(e);return n.getTime()===r.getTime()}function ke(t){return b(1,arguments),t instanceof Date||R(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function je(t){if(b(1,arguments),!ke(t)&&typeof t!="number")return!1;var e=j(t);return!isNaN(Number(e))}function Ae(t,e){b(2,arguments);var n=ne(e);return Ue(t,-n)}function w(t,e){for(var n=t<0?"-":"",r=Math.abs(t).toString();r.length<e;)r="0"+r;return n+r}var Ie={y:function(e,n){var r=e.getUTCFullYear(),o=r>0?r:1-r;return w(n==="yy"?o%100:o,n.length)},M:function(e,n){var r=e.getUTCMonth();return n==="M"?String(r+1):w(r+1,2)},d:function(e,n){return w(e.getUTCDate(),n.length)},a:function(e,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,n){return w(e.getUTCHours()%12||12,n.length)},H:function(e,n){return w(e.getUTCHours(),n.length)},m:function(e,n){return w(e.getUTCMinutes(),n.length)},s:function(e,n){return w(e.getUTCSeconds(),n.length)},S:function(e,n){var r=n.length,o=e.getUTCMilliseconds(),a=Math.floor(o*Math.pow(10,r-3));return w(a,n.length)}};function $e(t){return b(1,arguments),be(t,Date.now())}function Re(t){return b(1,arguments),be(t,ve(Date.now(),1))}var Ye=/(\w)\1*|''|'(''|[^'])+('|$)|./g,Fe=/^'([^]*?)'?$/,Xe=/''/g,ze=/[a-zA-Z]/;function Be(t,e){b(2,arguments);var n=j(t);if(!je(n))throw new RangeError("Invalid time value");var r=Pe(n),o=Ae(n,r),a=e.match(Ye);if(!a)return"";var i=a.map(function(c){if(c==="''")return"'";var u=c[0];if(u==="'")return We(c);var s=Ie[u];if(s)return s(o,c);if(u.match(ze))throw new RangeError("Format string contains an unescaped latin alphabet character `"+u+"`");return c}).join("");return i}function We(t){var e=t.match(Fe);return e?e[1].replace(Xe,"'"):t}const qe=t=>Number(t.substring(11,13)),we=()=>{const t=new Date,e={timeZone:"Europe/Stockholm",hour:"numeric"},n=t.toLocaleTimeString("ru-RU",e);return Number(n)},Ve=t=>t.charAt(0).toUpperCase()+t.slice(1),Ze=t=>t.toLocaleDateString("ru-RU",{weekday:"long"}),ie={TODAY:"Сегодня",TOMORROW:"Завтра"},Ge=t=>$e(t)?ie.TODAY:Re(t)?ie.TOMORROW:Ve(Ze(t)),ue=t=>t<10?`0${t}`:String(t);function Ke(t){let e;return{c(){e=p("span"),e.textContent="не удалось найти цену за киловатт-час"},m(n,r){$(n,e,r)},p:h,d(n){n&&v(e)}}}function Qe(t){let e,n;return{c(){e=p("span"),e.textContent=`${t[0]} эре`,n=x(" за киловатт-час"),m(e,"class","price svelte-1efxmbq")},m(r,o){$(r,e,o),$(r,n,o)},p:h,d(r){r&&(v(e),v(n))}}}function Je(t){let e,n,r;function o(c,u){return typeof c[0]=="number"?Qe:Ke}let i=o(t)(t);return{c(){e=p("div"),i.c(),n=B(),r=p("div"),r.textContent=`в Мальмё на ${t[1]}-${t[2]}`,m(r,"class","subHeader svelte-1efxmbq"),m(e,"class","header")},m(c,u){$(c,e,u),i.m(e,null),_(e,n),_(e,r)},p(c,[u]){i.p(c,u)},i:h,o:h,d(c){c&&v(e),i.d()}}}function et(t,e,n){var u;let{today:r}=e;const o=we(),a=(u=r.points.find(s=>s.hour===o))==null?void 0:u.price,i=`${ue(o)}:00`,c=`${ue(o+1)}:00`;return t.$$set=s=>{"today"in s&&n(3,r=s.today)},[a,i,c,r]}class tt extends M{constructor(e){super(),C(this,e,et,Je,D,{today:3})}}function nt(t){let e,n,r=Math.floor(t[1])+"",o,a,i,c,u;return{c(){e=p("dl"),n=p("dd"),o=x(r),a=B(),c=p("dt"),u=x(t[0]),m(n,"class",i="price "+(t[3]?"current":"")+" svelte-82h7id"),se(n,"--bar-height",t[2]+"%"),m(c,"class","hour svelte-82h7id"),m(e,"class","percentage svelte-82h7id")},m(s,l){$(s,e,l),_(e,n),_(n,o),_(n,a),_(e,c),_(c,u)},p(s,[l]){l&2&&r!==(r=Math.floor(s[1])+"")&&V(o,r),l&8&&i!==(i="price "+(s[3]?"current":"")+" svelte-82h7id")&&m(n,"class",i),l&4&&se(n,"--bar-height",s[2]+"%"),l&1&&V(u,s[0])},i:h,o:h,d(s){s&&v(e)}}}function rt(t,e,n){let{hour:r}=e,{price:o}=e,{height:a}=e,{isCurrentHour:i}=e;return t.$$set=c=>{"hour"in c&&n(0,r=c.hour),"price"in c&&n(1,o=c.price),"height"in c&&n(2,a=c.height),"isCurrentHour"in c&&n(3,i=c.isCurrentHour)},[r,o,a,i]}class ot extends M{constructor(e){super(),C(this,e,rt,nt,D,{hour:0,price:1,height:2,isCurrentHour:3})}}function le(t,e,n){const r=t.slice();return r[6]=e[n].hour,r[7]=e[n].price,r[8]=e[n].height,r[10]=n,r}function fe(t){let e,n;return e=new ot({props:{hour:t[6],price:t[7],height:t[8],isCurrentHour:t[10]===t[2]}}),{c(){L(e.$$.fragment)},m(r,o){E(e,r,o),n=!0},p:h,i(r){n||(g(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function st(t){let e,n,r,o,a,i=I(t[0]),c=[];for(let s=0;s<i.length;s+=1)c[s]=fe(le(t,i,s));const u=s=>y(c[s],1,1,()=>{c[s]=null});return{c(){e=p("article"),n=p("div");for(let s=0;s<c.length;s+=1)c[s].c();r=B(),o=p("h2"),o.textContent=`${Ge(t[1])}`,m(n,"class","percentages svelte-votryp"),m(o,"class","dayName svelte-votryp"),m(e,"class","day svelte-votryp")},m(s,l){$(s,e,l),_(e,n);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(n,null);_(e,r),_(e,o),a=!0},p(s,[l]){if(l&5){i=I(s[0]);let f;for(f=0;f<i.length;f+=1){const d=le(s,i,f);c[f]?(c[f].p(d,l),g(c[f],1)):(c[f]=fe(d),c[f].c(),g(c[f],1),c[f].m(n,null))}for(ee(),f=i.length;f<c.length;f+=1)u(f);te()}},i(s){if(!a){for(let l=0;l<i.length;l+=1)g(c[l]);a=!0}},o(s){c=c.filter(Boolean);for(let l=0;l<c.length;l+=1)y(c[l]);a=!1},d(s){s&&v(e),_e(c,s)}}}function ct(t,e,n){let{day:r}=e;const{points:o,start:a}=r,i=$e(a),c=we(),u=i?r.points.findIndex(({hour:s})=>s===c):void 0;return t.$$set=s=>{"day"in s&&n(3,r=s.day)},[o,a,u,r]}class at extends M{constructor(e){super(),C(this,e,ct,st,D,{day:3})}}function de(t,e,n){const r=t.slice();return r[1]=e[n],r}function he(t){let e,n;return e=new at({props:{day:t[1]}}),{c(){L(e.$$.fragment)},m(r,o){E(e,r,o),n=!0},p(r,o){const a={};o&1&&(a.day=r[1]),e.$set(a)},i(r){n||(g(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function it(t){let e,n,r,o,a;n=new tt({props:{today:t[0][0]}});let i=I(t[0]),c=[];for(let s=0;s<i.length;s+=1)c[s]=he(de(t,i,s));const u=s=>y(c[s],1,1,()=>{c[s]=null});return{c(){e=p("div"),L(n.$$.fragment),r=B(),o=p("div");for(let s=0;s<c.length;s+=1)c[s].c();m(o,"class","dataWrapper svelte-cydoa9"),m(e,"class","chart svelte-cydoa9")},m(s,l){$(s,e,l),E(n,e,null),_(e,r),_(e,o);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(o,null);a=!0},p(s,[l]){const f={};if(l&1&&(f.today=s[0][0]),n.$set(f),l&1){i=I(s[0]);let d;for(d=0;d<i.length;d+=1){const U=de(s,i,d);c[d]?(c[d].p(U,l),g(c[d],1)):(c[d]=he(U),c[d].c(),g(c[d],1),c[d].m(o,null))}for(ee(),d=i.length;d<c.length;d+=1)u(d);te()}},i(s){if(!a){g(n.$$.fragment,s);for(let l=0;l<i.length;l+=1)g(c[l]);a=!0}},o(s){y(n.$$.fragment,s),c=c.filter(Boolean);for(let l=0;l<c.length;l+=1)y(c[l]);a=!1},d(s){s&&v(e),T(n),_e(c,s)}}}function ut(t,e,n){let{data:r}=e;return t.$$set=o=>{"data"in o&&n(0,r=o.data)},[r]}class lt extends M{constructor(e){super(),C(this,e,ut,it,D,{data:0})}}function ft(t){let e;return{c(){e=p("div"),e.textContent="Загружаем цены. Это может занять около минуты.",m(e,"class","message svelte-1fvug33")},m(n,r){$(n,e,r)},p:h,i:h,o:h,d(n){n&&v(e)}}}class dt extends M{constructor(e){super(),C(this,e,null,ft,D,{})}}function ht(t){let e,n;return{c(){e=p("div"),n=x(t[0]),m(e,"class","message svelte-1fvug33")},m(r,o){$(r,e,o),_(e,n)},p(r,[o]){o&1&&V(n,r[0])},i:h,o:h,d(r){r&&v(e)}}}function gt(t,e,n){let{message:r}=e;return t.$$set=o=>{"message"in o&&n(0,r=o.message)},[r]}class mt extends M{constructor(e){super(),C(this,e,gt,ht,D,{message:0})}}const pt=t=>Math.round((t+Number.EPSILON)*100)/100,_t=t=>({price:pt(t.SEK_per_kWh*100),hour:qe(t.time_start)}),yt=t=>t.map(_t),ge=2,vt=t=>t.reduce((e,n,r)=>{if(r===0){const o=new Date().getHours(),a=n.points.findIndex(i=>i.hour===o);return[...e,{...n,points:n.points.slice(a>ge?a-ge:0)}]}return[...e,n]},[]),bt=t=>{let e=0;for(const o of t)for(const a of o.points)a.price>e&&(e=a.price);const r=90/e;return t.map(o=>({...o,points:o.points.map(a=>({...a,height:Math.round(a.price*r)}))}))},$t=t=>{const e=vt(t);return bt(e)},wt="SE4",St="https://www.elprisetjustnu.se/api/v1/prices",Dt=t=>{const e=Be(t,"yyyy/MM-dd");return`${St}/${e}_${wt}.json`},Et=async t=>await fetch(t).then(e=>e.json()).catch(()=>null),Tt=async()=>{const t=K(new Date),e=ve(t,1),n=[t,e].map(a=>{const i=Dt(a);return Et(i)}),r=await Promise.all(n),o=[t,e].reduce((a,i,c)=>{const u=r[c];return u===null?a:[...a,{start:i,points:yt(u)}]},[]);return $t(o)},Ct=async()=>{try{return{isSuccess:!0,data:await Tt()}}catch(t){return console.error(t),{isSuccess:!1,error:"Ошибка при загрузке данных"}}},Mt=150,Ot=150;let Y=null,F=null,X=null,z=null;const Q=()=>{Y=null,F=null,X=null,z=null},Nt=t=>{var e,n;t.touches.length===1&&(Y=((e=t.touches.item(0))==null?void 0:e.clientX)??null,F=((n=t.touches.item(0))==null?void 0:n.clientY)??null)},Ht=t=>{var e,n;t.touches.length===1&&(X=((e=t.touches.item(0))==null?void 0:e.clientX)??null,z=((n=t.touches.item(0))==null?void 0:n.clientY)??null)},xt=()=>{Q()},Lt=t=>{if(!Y||!F||!X||!z){Q();return}const e=X-Y,n=z-F,r=Math.abs(e)<Ot;n>Mt&&r&&t(),Q()},Ut=t=>{const e=()=>Lt(t);return{init:()=>{document.addEventListener("touchstart",Nt,!1),document.addEventListener("touchmove",Ht,!1),document.addEventListener("touchcancel",xt,!1),document.addEventListener("touchend",e,!1)}}};function Pt(t){let e,n;return e=new mt({props:{message:t[1]??"Неизвестная ошибка"}}),{c(){L(e.$$.fragment)},m(r,o){E(e,r,o),n=!0},p(r,o){const a={};o&2&&(a.message=r[1]??"Неизвестная ошибка"),e.$set(a)},i(r){n||(g(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function kt(t){let e,n;return e=new lt({props:{data:t[0]}}),{c(){L(e.$$.fragment)},m(r,o){E(e,r,o),n=!0},p(r,o){const a={};o&1&&(a.data=r[0]),e.$set(a)},i(r){n||(g(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function jt(t){let e,n;return e=new dt({}),{c(){L(e.$$.fragment)},m(r,o){E(e,r,o),n=!0},p:h,i(r){n||(g(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function At(t){let e,n,r,o;const a=[jt,kt,Pt],i=[];function c(u,s){return u[2]?0:u[3]&&u[0]?1:2}return e=c(t),n=i[e]=a[e](t),{c(){n.c(),r=Te()},m(u,s){i[e].m(u,s),$(u,r,s),o=!0},p(u,[s]){let l=e;e=c(u),e===l?i[e].p(u,s):(ee(),y(i[l],1,1,()=>{i[l]=null}),te(),n=i[e],n?n.p(u,s):(n=i[e]=a[e](u),n.c()),g(n,1),n.m(r.parentNode,r))},i(u){o||(g(n),o=!0)},o(u){y(n),o=!1},d(u){u&&v(r),i[e].d(u)}}}function It(t,e,n){let r,o=!0,a,i;const c=()=>{n(2,o=!0),Ct().then(u=>{u.isSuccess?(n(0,a=u.data),n(1,i=void 0)):(n(0,a=void 0),n(1,i=u.error)),n(2,o=!1)})};return c(),Ut(c).init(),t.$$.update=()=>{t.$$.dirty&3&&n(3,r=a!==void 0&&i===void 0)},[a,i,o,r]}class Rt extends M{constructor(e){super(),C(this,e,It,At,D,{})}}new Rt({target:document.getElementById("app")});
