(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function h(){}function ht(t){return t()}function et(){return Object.create(null)}function T(t){t.forEach(ht)}function mt(t){return typeof t=="function"}function E(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function vt(t){return Object.keys(t).length===0}function _(t,e){t.appendChild(e)}function b(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode&&t.parentNode.removeChild(t)}function pt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function S(t){return document.createTextNode(t)}function X(){return S(" ")}function Et(){return S("")}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function St(t){return Array.from(t.childNodes)}function K(t,e){e=""+e,t.data!==e&&(t.data=e)}function nt(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}let G;function P(t){G=t}const M=[],rt=[];let x=[];const ot=[],Dt=Promise.resolve();let W=!1;function Ot(){W||(W=!0,Dt.then(gt))}function V(t){x.push(t)}const B=new Set;let N=0;function gt(){if(N!==0)return;const t=G;do{try{for(;N<M.length;){const e=M[N];N++,P(e),kt(e.$$)}}catch(e){throw M.length=0,N=0,e}for(P(null),M.length=0,N=0;rt.length;)rt.pop()();for(let e=0;e<x.length;e+=1){const n=x[e];B.has(n)||(B.add(n),n())}x.length=0}while(M.length);for(;ot.length;)ot.pop()();W=!1,B.clear(),P(t)}function kt(t){if(t.fragment!==null){t.update(),T(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(V)}}function Ht(t){const e=[],n=[];x.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),x=e}const R=new Set;let v;function Q(){v={r:0,c:[],p:v}}function J(){v.r||T(v.c),v=v.p}function p(t,e){t&&t.i&&(R.delete(t),t.i(e))}function $(t,e,n,r){if(t&&t.o){if(R.has(t))return;R.add(t),v.c.push(()=>{R.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function j(t){return t?.length!==void 0?t:Array.from(t)}function C(t){t&&t.c()}function D(t,e,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),V(()=>{const i=t.$$.on_mount.map(ht).filter(mt);t.$$.on_destroy?t.$$.on_destroy.push(...i):T(i),t.$$.on_mount=[]}),o.forEach(V)}function O(t,e){const n=t.$$;n.fragment!==null&&(Ht(n.after_update),T(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Nt(t,e){t.$$.dirty[0]===-1&&(M.push(t),Ot(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function k(t,e,n,r,o,i,u=null,s=[-1]){const l=G;P(t);const c=t.$$={fragment:null,ctx:[],props:i,update:h,not_equal:o,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:et(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};u&&u(c.root);let f=!1;if(c.ctx=n?n(t,e.props||{},(a,d,...L)=>{const tt=L.length?L[0]:d;return c.ctx&&o(c.ctx[a],c.ctx[a]=tt)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](tt),f&&Nt(t,a)),d}):[],c.update(),f=!0,T(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const a=St(e.target);c.fragment&&c.fragment.l(a),a.forEach(y)}else c.fragment&&c.fragment.c();e.intro&&p(t.$$.fragment),D(t,e.target,e.anchor),gt()}P(l)}class H{$$=void 0;$$set=void 0;$destroy(){O(this,1),this.$destroy=h}$on(e,n){if(!mt(n))return h;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!vt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Mt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Mt);const ct=Symbol.for("constructDateFrom");function A(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&ct in t?t[ct](e):t instanceof Date?new t.constructor(e):new Date(e)}function z(t,e){return A(t,t)}function _t(t,e,n){const r=z(t);return isNaN(e)?A(t,NaN):(r.setDate(r.getDate()+e),r)}function xt(t,...e){const n=A.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function Z(t,e){const n=z(t);return n.setHours(0,0,0,0),n}function yt(t){return A(t,Date.now())}function $t(t,e,n){const[r,o]=xt(n?.in,t,e);return+Z(r)==+Z(o)}function Ct(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Lt(t){return!(!Ct(t)&&typeof t!="number"||isNaN(+z(t)))}function w(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Pt={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return w(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):w(n+1,2)},d(t,e){return w(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return w(t.getHours()%12||12,e.length)},H(t,e){return w(t.getHours(),e.length)},m(t,e){return w(t.getMinutes(),e.length)},s(t,e){return w(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),o=Math.trunc(r*Math.pow(10,n-3));return w(o,e.length)}};function bt(t,e){return $t(A(t,t),yt(t))}function Tt(t,e){return $t(t,_t(yt(t),1),e)}const At=/(\w)\1*|''|'(''|[^'])+('|$)|./g,Rt=/^'([^]*?)'?$/,jt=/''/g,Ft=/[a-zA-Z]/;function It(t,e){const n=z(t);if(!Lt(n))throw new RangeError("Invalid time value");const r=e.match(At);return r?r.map(i=>{if(i==="''")return"'";const u=i[0];if(u==="'")return Yt(i);const s=Pt[u];if(s)return s(n,i);if(u.match(Ft))throw new RangeError("Format string contains an unescaped latin alphabet character `"+u+"`");return i}).join(""):""}function Yt(t){const e=t.match(Rt);return e?e[1].replace(jt,"'"):t}const Ut=t=>t.substring(14,16)!=="00"?null:Number(t.substring(11,13)),wt=()=>{const t=new Date,e={timeZone:"Europe/Stockholm",hour:"numeric"},n=t.toLocaleTimeString("ru-RU",e);return Number(n)},Xt=t=>t.charAt(0).toUpperCase()+t.slice(1),zt=t=>t.toLocaleDateString("ru-RU",{weekday:"long"}),st={TODAY:"Сегодня",TOMORROW:"Завтра"},Bt=t=>bt(t)?st.TODAY:Tt(t)?st.TOMORROW:Xt(zt(t)),it=t=>t<10?`0${t}`:String(t);function Wt(t){let e;return{c(){e=g("span"),e.textContent="не удалось найти цену за киловатт-час"},m(n,r){b(n,e,r)},p:h,d(n){n&&y(e)}}}function Vt(t){let e,n;return{c(){e=g("span"),e.textContent=`${t[0]} эре`,n=S(" за киловатт-час"),m(e,"class","price svelte-ocn60c")},m(r,o){b(r,e,o),b(r,n,o)},p:h,d(r){r&&(y(e),y(n))}}}function Zt(t){let e,n,r,o;function i(l,c){return typeof l[0]=="number"?Vt:Wt}let s=i(t)(t);return{c(){e=g("div"),n=g("div"),s.c(),r=X(),o=g("div"),o.textContent=`в Мальмё на ${t[1]}-${t[2]}`,m(o,"class","subHeader svelte-ocn60c"),m(n,"class","pricing"),m(e,"class","header svelte-ocn60c")},m(l,c){b(l,e,c),_(e,n),s.m(n,null),_(n,r),_(n,o)},p(l,[c]){s.p(l,c)},i:h,o:h,d(l){l&&y(e),s.d()}}}function qt(t,e,n){let{today:r}=e;const o=wt(),i=r.points.find(l=>l.hour===o)?.price,u=`${it(o)}:00`,s=`${it(o+1)}:00`;return t.$$set=l=>{"today"in l&&n(3,r=l.today)},[i,u,s,r]}class Kt extends H{constructor(e){super(),k(this,e,qt,Zt,E,{today:3})}}function Gt(t){let e;return{c(){e=S(" ")},m(n,r){b(n,e,r)},p:h,d(n){n&&y(e)}}}function Qt(t){let e;return{c(){e=S(t[0])},m(n,r){b(n,e,r)},p(n,r){r&1&&K(e,n[0])},d(n){n&&y(e)}}}function Jt(t){let e,n,r=Math.floor(t[1])+"",o,i,u,s;function l(a,d){return typeof a[0]=="number"?Qt:Gt}let c=l(t),f=c(t);return{c(){e=g("dl"),n=g("dd"),o=S(r),i=X(),s=g("dt"),f.c(),m(n,"class",u="price "+(t[3]?"current":"")+" svelte-82h7id"),nt(n,"--bar-height",t[2]+"%"),m(s,"class","hour svelte-82h7id"),m(e,"class","percentage svelte-82h7id")},m(a,d){b(a,e,d),_(e,n),_(n,o),_(n,i),_(e,s),f.m(s,null)},p(a,[d]){d&2&&r!==(r=Math.floor(a[1])+"")&&K(o,r),d&8&&u!==(u="price "+(a[3]?"current":"")+" svelte-82h7id")&&m(n,"class",u),d&4&&nt(n,"--bar-height",a[2]+"%"),c===(c=l(a))&&f?f.p(a,d):(f.d(1),f=c(a),f&&(f.c(),f.m(s,null)))},i:h,o:h,d(a){a&&y(e),f.d()}}}function te(t,e,n){let{hour:r}=e,{price:o}=e,{height:i}=e,{isCurrentHour:u}=e;return t.$$set=s=>{"hour"in s&&n(0,r=s.hour),"price"in s&&n(1,o=s.price),"height"in s&&n(2,i=s.height),"isCurrentHour"in s&&n(3,u=s.isCurrentHour)},[r,o,i,u]}class ee extends H{constructor(e){super(),k(this,e,te,Jt,E,{hour:0,price:1,height:2,isCurrentHour:3})}}function ut(t,e,n){const r=t.slice();return r[6]=e[n].hour,r[7]=e[n].price,r[8]=e[n].height,r[10]=n,r}function lt(t){let e,n;return e=new ee({props:{hour:t[6],price:t[7],height:t[8],isCurrentHour:t[10]===t[2]}}),{c(){C(e.$$.fragment)},m(r,o){D(e,r,o),n=!0},p:h,i(r){n||(p(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){O(e,r)}}}function ne(t){let e,n,r,o,i,u=j(t[0]),s=[];for(let c=0;c<u.length;c+=1)s[c]=lt(ut(t,u,c));const l=c=>$(s[c],1,1,()=>{s[c]=null});return{c(){e=g("article"),n=g("div");for(let c=0;c<s.length;c+=1)s[c].c();r=X(),o=g("h2"),o.textContent=`${Bt(t[1])}`,m(n,"class","percentages svelte-votryp"),m(o,"class","dayName svelte-votryp"),m(e,"class","day svelte-votryp")},m(c,f){b(c,e,f),_(e,n);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,null);_(e,r),_(e,o),i=!0},p(c,[f]){if(f&5){u=j(c[0]);let a;for(a=0;a<u.length;a+=1){const d=ut(c,u,a);s[a]?(s[a].p(d,f),p(s[a],1)):(s[a]=lt(d),s[a].c(),p(s[a],1),s[a].m(n,null))}for(Q(),a=u.length;a<s.length;a+=1)l(a);J()}},i(c){if(!i){for(let f=0;f<u.length;f+=1)p(s[f]);i=!0}},o(c){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)$(s[f]);i=!1},d(c){c&&y(e),pt(s,c)}}}function re(t,e,n){let{day:r}=e;const{points:o,start:i}=r,u=bt(i),s=wt(),l=u?r.points.findIndex(({hour:c})=>c===s):void 0;return t.$$set=c=>{"day"in c&&n(3,r=c.day)},[o,i,l,r]}class oe extends H{constructor(e){super(),k(this,e,re,ne,E,{day:3})}}function at(t,e,n){const r=t.slice();return r[1]=e[n],r}function ft(t){let e,n;return e=new oe({props:{day:t[1]}}),{c(){C(e.$$.fragment)},m(r,o){D(e,r,o),n=!0},p(r,o){const i={};o&1&&(i.day=r[1]),e.$set(i)},i(r){n||(p(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){O(e,r)}}}function ce(t){let e,n,r,o,i;n=new Kt({props:{today:t[0][0]}});let u=j(t[0]),s=[];for(let c=0;c<u.length;c+=1)s[c]=ft(at(t,u,c));const l=c=>$(s[c],1,1,()=>{s[c]=null});return{c(){e=g("div"),C(n.$$.fragment),r=X(),o=g("div");for(let c=0;c<s.length;c+=1)s[c].c();m(o,"class","dataWrapper svelte-cydoa9"),m(e,"class","chart svelte-cydoa9")},m(c,f){b(c,e,f),D(n,e,null),_(e,r),_(e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,null);i=!0},p(c,[f]){const a={};if(f&1&&(a.today=c[0][0]),n.$set(a),f&1){u=j(c[0]);let d;for(d=0;d<u.length;d+=1){const L=at(c,u,d);s[d]?(s[d].p(L,f),p(s[d],1)):(s[d]=ft(L),s[d].c(),p(s[d],1),s[d].m(o,null))}for(Q(),d=u.length;d<s.length;d+=1)l(d);J()}},i(c){if(!i){p(n.$$.fragment,c);for(let f=0;f<u.length;f+=1)p(s[f]);i=!0}},o(c){$(n.$$.fragment,c),s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)$(s[f]);i=!1},d(c){c&&y(e),O(n),pt(s,c)}}}function se(t,e,n){let{data:r}=e;return t.$$set=o=>{"data"in o&&n(0,r=o.data)},[r]}class ie extends H{constructor(e){super(),k(this,e,se,ce,E,{data:0})}}function ue(t){let e;return{c(){e=g("div"),e.textContent="Загружаем цены. Это может занять около минуты.",m(e,"class","message svelte-1fvug33")},m(n,r){b(n,e,r)},p:h,i:h,o:h,d(n){n&&y(e)}}}class le extends H{constructor(e){super(),k(this,e,null,ue,E,{})}}function ae(t){let e,n;return{c(){e=g("div"),n=S(t[0]),m(e,"class","message svelte-1fvug33")},m(r,o){b(r,e,o),_(e,n)},p(r,[o]){o&1&&K(n,r[0])},i:h,o:h,d(r){r&&y(e)}}}function fe(t,e,n){let{message:r}=e;return t.$$set=o=>{"message"in o&&n(0,r=o.message)},[r]}class de extends H{constructor(e){super(),k(this,e,fe,ae,E,{message:0})}}const he=t=>Math.round((t+Number.EPSILON)*100)/100,me=t=>({price:he(t.SEK_per_kWh*100),hour:Ut(t.time_start)}),pe=t=>t.map(me),dt=2,ge=t=>t.reduce((e,n,r)=>{if(r===0){const o=new Date().getHours(),i=n.points.findIndex(u=>u.hour===o);return[...e,{...n,points:n.points.slice(i>dt?i-dt:0)}]}return[...e,n]},[]),_e=t=>{let e=0;for(const o of t)for(const i of o.points)i.price>e&&(e=i.price);const r=90/e;return t.map(o=>({...o,points:o.points.map(i=>({...i,height:Math.round(i.price*r)}))}))},ye=t=>{const e=ge(t);return _e(e)},$e="SE4",be="https://www.elprisetjustnu.se/api/v1/prices",we=t=>{const e=It(t,"yyyy/MM-dd");return`${be}/${e}_${$e}.json`},ve=async t=>await fetch(t).then(e=>e.json()).catch(()=>null),Ee=async()=>{const t=Z(new Date),e=_t(t,1),n=[t,e].map(i=>{const u=we(i);return ve(u)}),r=await Promise.all(n),o=[t,e].reduce((i,u,s)=>{const l=r[s];return l===null?i:[...i,{start:u,points:pe(l)}]},[]);return ye(o)},Se=async()=>{try{return{isSuccess:!0,data:await Ee()}}catch(t){return console.error(t),{isSuccess:!1,error:"Ошибка при загрузке данных"}}},De=150,Oe=150;let F=null,I=null,Y=null,U=null;const q=()=>{F=null,I=null,Y=null,U=null},ke=t=>{t.touches.length===1&&(F=t.touches.item(0)?.clientX??null,I=t.touches.item(0)?.clientY??null)},He=t=>{t.touches.length===1&&(Y=t.touches.item(0)?.clientX??null,U=t.touches.item(0)?.clientY??null)},Ne=()=>{q()},Me=t=>{if(!F||!I||!Y||!U){q();return}const e=Y-F,n=U-I,r=Math.abs(e)<Oe;n>De&&r&&t(),q()},xe=t=>{const e=()=>Me(t);return{init:()=>{document.addEventListener("touchstart",ke,!1),document.addEventListener("touchmove",He,!1),document.addEventListener("touchcancel",Ne,!1),document.addEventListener("touchend",e,!1)}}};function Ce(t){let e,n;return e=new de({props:{message:t[1]??"Неизвестная ошибка"}}),{c(){C(e.$$.fragment)},m(r,o){D(e,r,o),n=!0},p(r,o){const i={};o&2&&(i.message=r[1]??"Неизвестная ошибка"),e.$set(i)},i(r){n||(p(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){O(e,r)}}}function Le(t){let e,n;return e=new ie({props:{data:t[0]}}),{c(){C(e.$$.fragment)},m(r,o){D(e,r,o),n=!0},p(r,o){const i={};o&1&&(i.data=r[0]),e.$set(i)},i(r){n||(p(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){O(e,r)}}}function Pe(t){let e,n;return e=new le({}),{c(){C(e.$$.fragment)},m(r,o){D(e,r,o),n=!0},p:h,i(r){n||(p(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){O(e,r)}}}function Te(t){let e,n,r,o;const i=[Pe,Le,Ce],u=[];function s(l,c){return l[2]?0:l[3]&&l[0]?1:2}return e=s(t),n=u[e]=i[e](t),{c(){n.c(),r=Et()},m(l,c){u[e].m(l,c),b(l,r,c),o=!0},p(l,[c]){let f=e;e=s(l),e===f?u[e].p(l,c):(Q(),$(u[f],1,1,()=>{u[f]=null}),J(),n=u[e],n?n.p(l,c):(n=u[e]=i[e](l),n.c()),p(n,1),n.m(r.parentNode,r))},i(l){o||(p(n),o=!0)},o(l){$(n),o=!1},d(l){l&&y(r),u[e].d(l)}}}function Ae(t,e,n){let r,o=!0,i,u;const s=()=>{n(2,o=!0),Se().then(l=>{l.isSuccess?(n(0,i=l.data),n(1,u=void 0)):(n(0,i=void 0),n(1,u=l.error)),n(2,o=!1)})};return s(),xe(s).init(),t.$$.update=()=>{t.$$.dirty&3&&n(3,r=i!==void 0&&u===void 0)},[i,u,o,r]}class Re extends H{constructor(e){super(),k(this,e,Ae,Te,E,{})}}new Re({target:document.getElementById("app")});
